/* Copyright Â© 2013 Spectrum IT Solutions Gmbh - All Rights Reserved */
var AJS,AJSBaseActor,AJSCircle,AJSColor3,AJSPhysicsProperties,AJSPolygon,AJSRectangle,AJSTriangle,AJSUtilParam,AJSVector2,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};AJSUtilParam=function(){function a(){}return a.required=function(a,b){var c,d,e,f;if(void 0===a)throw new Error("Required argument missing!");if(b instanceof Array){for(c=!1,e=0,f=b.length;f>e;e++)if(d=b[e],a===d){c=!0;break}if(!c)throw new error("Required argument is not of a valid value!")}return a},a.optional=function(a,b,c){var d,e,f,g;if(void 0===a&&(a=b),c instanceof Array){for(d=!1,f=0,g=c.length;g>f;f++)if(e=c[f],a===e){d=!0;break}if(!d)throw new error("Required argument is not of a valid value!")}return a},a}(),void 0===window.param&&(window.param=AJSUtilParam),AJSVector2=function(){function a(a,b){this.x=a||0,this.y=b||0}return a.prototype.negative=function(){return new a(-this.x,-this.y)},a.prototype.add=function(b){return b instanceof a?new a(this.x+b.x,this.y+b.y):new a(this.x+b,this.y+b)},a.prototype.subtract=function(b){return b instanceof a?new a(this.x-b.x,this.y-b.y):new a(this.x-b,this.y-b)},a.prototype.multiply=function(b){return b instanceof a?new a(this.x*b.x,this.y*b.y):new a(this.x*b,this.y*b)},a.prototype.divide=function(b){return b instanceof a?new a(this.x/b.x,this.y/b.y):new a(this.x/b,this.y/b)},a.prototype.equals=function(a){return this.x===a.x&&this.y===a.y},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y},a.prototype.cross=function(a){return this.x*a.y-this.y*a.x},a.prototype.ortho=function(){return new a(this.y,-this.x)},a.prototype.length=function(){return Math.sqrt(this.dot(this))},a.prototype.normalize=function(){return this.divide(this.length())},a.prototype.toString=function(){return"("+this.x+", "+this.y+")"},a}(),AJSColor3=function(){function a(a,b,c){this._r=param.optional(a,0),this._g=param.optional(b,0),this._b=param.optional(c,0)}return a.prototype.getR=function(a){return a!==!0?this._r:0===this._r?a?0:0:this._r/255},a.prototype.getG=function(a){return a!==!0?this._g:0===this._g?a?0:0:this._g/255},a.prototype.getB=function(a){return a!==!0?this._b:0===this._b?a?0:0:this._b/255},a.prototype.setR=function(a){return 0>a&&(a=0),a>255&&(a=255),this._r=a},a.prototype.setG=function(a){return 0>a&&(a=0),a>255&&(a=255),this._g=a},a.prototype.setB=function(a){return 0>a&&(a=0),a>255&&(a=255),this._b=a},a.prototype.toString=function(){return"("+this._r+", "+this._g+", "+this._b+")"},a}(),AJSPhysicsProperties=function(){function a(a){this._mass=param.optional(a.mass,0),this._elasticity=param.optional(a.elasticity,0),this._friction=param.optional(a.friction,0)}return a.prototype.getMass=function(){return this._mass},a.prototype.getElasticity=function(){return this._elasticity},a.prototype.getFriction=function(){return this._friction},a}(),AJSBaseActor=function(){function a(a,b,c,d){if(this._verts=a,this._verts=param.optional(this._verts),this._m=param.optional(b,0),this._f=param.optional(c,.2),this._e=param.optional(d,.3),null===this.interfaceActorCreate)throw new Error("Actor class doesn't provide interface actor creation!");if(0>b&&(b=0),void 0!==this._verts&&null!==this._verts&&this._verts.length<6)throw new Error("At least three vertices must be provided");if(this._psyx=!1,this._id=this.interfaceActorCreate(),-1===this._id)throw new Error("Failed to create actor!");this.setPosition(new AJSVector2),this.setRotation(0),this.setColor(new AJSColor3(255,255,255))}return a.prototype.interfaceActorCreate=null,a.prototype.destroy=function(){return AJS.info("Destroying actor "+this._id),window.AdefyRE.Actors().destroyActor(this._id)},a.prototype.setLayer=function(a){return AJS.info("Setting actor ("+this._id+") layer "+a),window.AdefyRE.Actors().setActorLayer(param.required(a),this._id),this},a.prototype.setPhysicsLayer=function(a){return AJS.info("Setting actor ("+this._id+") physics layer "+a),window.AdefyRE.Actors().setActorPhysicsLayer(param.required(a),this._id),this},a.prototype._setPhysicsVertices=function(a){return param.required(a),AJS.info("Setting actor physics vertices ("+this._id+") ["+a.length+" verts]"),window.AdefyRE.Actors().setPhysicsVertices(JSON.stringify(a),this._id)},a.prototype._setRenderMode=function(a){var b;return b=param.required(a,[0,1,2]),AJS.info("Setting actor ("+this._id+") render mode "+b),window.AdefyRE.Actors().setRenderMode(b,this._id)},a.prototype._updateVertices=function(){return AJS.info("Updating actor ("+this._id+") vertices ["+this._verts.length+" verts]"),window.AdefyRE.Actors().updateVertices(JSON.stringify(this._verts),this._id)},a.prototype._fetchVertices=function(){var a,b;if(AJS.info("Fetching actor vertices ("+this._id+")..."),b=window.AdefyRE.Actors().getVertices(this._id),b.length>0)try{this._verts=JSON.parse(b)}catch(c){a=c,console.error("Invalid verts ["+a+"]: "+b)}return this._verts},a.prototype.getId=function(){return this._id},a.prototype.getLayer=function(){return AJS.info("Fetching actor layer..."),this._layer=window.AdefyRE.Actors().getActorLayer(this._id)},a.prototype.getPhysicsLayer=function(){return AJS.info("Fetching actor physics layer..."),this._physicsLayer=window.AdefyRE.Actors().getActorPhysicsLayer(this._id)},a.prototype.getVisible=function(){return AJS.info("Fetching actor visiblity..."),this._visible=window.AdefyRE.Actors().getActorVisible(this._id)},a.prototype.getOpacity=function(){return AJS.info("Fetching actor opacity..."),this._opacity=window.AdefyRE.Actors().getActorOpacity(this._id)},a.prototype.getPosition=function(){var a,b;return AJS.info("Fetching actor position..."),a=JSON.parse(window.AdefyRE.Actors().getActorPosition(this._id)),b=AJS.getAutoScale(),a.x/=b.x,a.y/=b.y,new AJSVector2(a.x,a.y)},a.prototype.getRotation=function(a){return AJS.info("Fetching actor rotation [radians: "+a+"]..."),a!==!0&&(a=!1),window.AdefyRE.Actors().getActorRotation(this._id,a)},a.prototype.getColor=function(){var a;return AJS.info("Fetching actor ("+this._id+") color..."),a=JSON.parse(window.AdefyRE.Actors().getActorColor(this._id)),new AJSColor3(a.r,a.g,a.b)},a.prototype.getPhysics=function(){return AJS.info("Fetching actor ("+this._id+") physics..."),this._psyx?new AJSPhysicsProperties({mass:this._m,elasticity:this._e,friction:this._f}):null},a.prototype.getMass=function(){return AJS.info("Fetching actor ("+this._id+") mass..."),this._m},a.prototype.getElasticity=function(){return AJS.info("Fetching actor ("+this._id+") elasticity..."),this._e},a.prototype.getFriction=function(){return AJS.info("Fetching actor ("+this._id+") friction..."),this._f},a.prototype.setVisible=function(a){return this._visible=a,AJS.info("Setting actor visiblity ("+this._id+") "+this._visible),window.AdefyRE.Actors().setActorVisible(this._visible,this._id),this},a.prototype.setOpacity=function(a){return this._opacity=a,AJS.info("Setting actor opacty ("+this._id+") "+this._opacity),window.AdefyRE.Actors().setActorOpacity(this._opacity,this._id),this},a.prototype.setPosition=function(a){var b;return AJS.info("Setting actor position ("+this._id+") "+JSON.stringify(a)),b=AJS.getAutoScale(),a.x*=b.x,a.y*=b.y,this._position=a,window.AdefyRE.Actors().setActorPosition(a.x,a.y,this._id),this},a.prototype.setRotation=function(a,b){return AJS.info("Setting actor ("+this._id+") rotation "+a+" [radians: "+b+"]"),b!==!0&&(b=!1),this._rotation=a,window.AdefyRE.Actors().setActorRotation(a,this._id,b),this},a.prototype.setColor=function(a){return AJS.info("Setting actor ("+this._id+") color "+JSON.stringify(a)),this._color=a,window.AdefyRE.Actors().setActorColor(a._r,a._g,a._b,this._id),this},a.prototype.setTexture=function(a){return AJS.info("Setting actor ("+this._id+") texture "+a),this._texture=a,window.AdefyRE.Actors().setActorTexture(a,this._id),this},a.prototype.setTextureRepeat=function(a,b){return b=param.optional(b,1),AJS.info("Setting actor ("+this._id+") texture repeat ("+a+", "+b+")"),this._textureRepeat={x:a,y:b},window.AdefyRE.Actors().setActorTextureRepeat(a,b,this._id),this},a.prototype.getTexture=function(){return this._texture},a.prototype.getTextureRepeat=function(){var a;return this._textureRepeat||(a=window.AdefyRE.Actors().getActorTextureRepeat(this._id),this._textureRepeat=JSON.parse(a)),this._textureRepeat},a.prototype.setPhysics=function(a){return this._psyx&&this.enablePsyx(a.mass,a.friction,a.elasticity),this},a.prototype.setMass=function(a){return this._m=a,this.setPhysics({mass:this._m}),this},a.prototype.setElasticity=function(a){return this._e=a,this.setPhysics({elasticity:this._e}),this},a.prototype.setFriction=function(a){return this._f=a,this.setPhysics({friction:this._f}),this},a.prototype.hasPsyx=function(){return this._psyx},a.prototype.enablePsyx=function(a,b,c){return this._m=param.optional(a,this._m),this._f=param.optional(b,this._f),this._e=param.optional(c,this._e),AJS.info("Enabling actor physics ("+this._id+") [m: "+a+", f: "+b+", e: "+c+"]"),this._psyx=window.AdefyRE.Actors().enableActorPhysics(this._m,this._f,this._e,this._id),this},a.prototype.disablePsyx=function(){return AJS.info("Disabling actor ("+this._id+") physics..."),window.AdefyRE.Actors().destroyPhysicsBody(this._id)&&(this._psyx=!1),this},a.prototype.attachTexture=function(a,b,c,d,e,f){var g;return param.required(a),param.required(b),param.required(c),d=param.optional(d,0),e=param.optional(e,0),f=param.optional(f,0),AJS.info("Attaching texture "+a+" "+b+"x"+c+" to actor ("+this._id+")"),g=AJS.getAutoScale(),d*=g.x,e*=g.y,b===c?(g=(g.x+g.y)/2,b*=g,c*=g):(b*=g.x,c*=g.y),window.AdefyRE.Actors().attachTexture(a,b,c,d,e,f,this._id)},a.prototype.removeAttachment=function(){return AJS.info("Removing actor ("+this._id+") texture attachment"),window.AdefyRE.Actors().removeAttachment(this._id)},a.prototype.setAttachmentVisible=function(a){return param.required(a),AJS.info("Setting actor texture attachment visiblity ["+a+"]"),window.AdefyRE.Actors().setAttachmentVisible(a,this._id)},a.prototype.mapAnimation=function(){return null},a.prototype.canMapAnimation=function(){return!1},a.prototype.absoluteMapping=function(){return!1},a.prototype.rotate=function(a,b,c,d){return param.required(a),void 0===b?this.setRotation(a):(void 0===c&&(c=0),void 0===d&&(d=[]),AJS.animate(this,[["rotation"]],[{endVal:a,controlPoints:d,duration:b,property:"rotation",start:c}])),this},a.prototype.move=function(a,b,c,d,e){var f,g,h,i;if(g=AJS.getAutoScale(),null!==a&&(a*=g.x),null!==b&&(b*=g.y),void 0===c)(null===a||void 0===a)&&(a=this.getPosition().x),(null===b||void 0===b)&&(b=this.getPosition().y),this.setPosition({x:a,y:b});else{for(void 0===d&&(d=0),void 0===e&&(e=[]),h=0,i=e.length;i>h;h++)f=e[h],f.y>1&&(f.y*=null===a?g.y:null===b?g.x:(g.x+g.y)/2);null!==a&&AJS.animate(this,[["position","x"]],[{endVal:a,controlPoints:e,duration:c,start:d}]),null!==b&&AJS.animate(this,[["position","y"]],[{endVal:b,controlPoints:e,duration:c,start:d}])}return this},a.prototype.colorTo=function(a,b,c,d,e,f){return void 0===d?((null===a||void 0===a)&&(a=this.getColor().r),(null===b||void 0===b)&&(b=this.getColor().g),(null===c||void 0===c)&&(c=this.getColor().b),this.setColor({_r:a,_g:b,_b:c})):(void 0===e&&(e=0),void 0===f&&(f=[]),null!==a&&AJS.animate(this,[["color","r"]],[{endVal:a,controlPoints:f,duration:d,start:e}]),null!==b&&AJS.animate(this,[["color","g"]],[{endVal:b,controlPoints:f,duration:d,start:e}]),null!==c&&AJS.animate(this,[["color","b"]],[{endVal:c,controlPoints:f,duration:d,start:e}])),this},a}(),AJSRectangle=function(a){function b(a){var c,d;if(a=param.required(a),this._width=param.required(a.w),this._height=param.required(a.h),this._width<=0)throw new Error("Width must be greater than 0");if(this._height<=0)throw new Error("Height must be greater than 0");d=AJS.getAutoScale(),this._width===this._height?(d=(d.x+d.y)/2,a.noScaleW!==!0&&(this._width*=d),a.noScaleH!==!0&&(this._height*=d)):a.scaleAR===!0?(c=this._width/this._height,d=(d.x+d.y)/2,this._width>this._height?(this._height*=d,this._width=c*this._height):(this._width*=d,this._height=this._width/c)):(a.noScaleW!==!0&&(this._width*=d.x),a.noScaleH!==!0&&(this._height*=d.y)),b.__super__.constructor.call(this,null,a.mass,a.friction,a.elasticity),a.color instanceof AJSColor3?this.setColor(a.color):void 0!==a.color&&void 0!==a.color.r&&this.setColor(new AJSColor3(a.color.r,a.color.g,a.color.b)),a.position instanceof AJSVector2?this.setPosition(a.position):void 0!==a.position&&void 0!==a.position.x&&this.setPosition(new AJSVector2(a.position.x,a.position.y)),"number"==typeof a.rotation&&this.setRotation(a.rotation),a.psyx&&this.enablePsyx()}return __extends(b,a),b.prototype.interfaceActorCreate=function(){return AJS.info("Creating rectangle actor ("+this._width+"x"+this._height+")"),window.AdefyRE.Actors().createRectangleActor(this._width,this._height)},b.prototype.getWidth=function(){return AJS.info("Fetching actor ("+this._id+") width..."),this._width=window.AdefyRE.Actors().getRectangleActorWidth(this._id)},b.prototype.getHeight=function(){return AJS.info("Fetching actor ("+this._id+") height..."),this._height=window.AdefyRE.Actors().getRectangleActorHeight(this._id)},b.prototype.setHeight=function(a){if(param.required(a),0>=a)throw new Error("New height must be >0 !");return AJS.info("Setting actor ("+this._id+") height ["+a+"]..."),this._height=a,window.AdefyRE.Actors().setRectangleActorHeight(this._id,a),this},b.prototype.setWidth=function(a){if(param.required(a),0>=a)throw new Error("New width must be >0 !");return AJS.info("Setting actor ("+this._id+") width ["+a+"]..."),this._width=a,window.AdefyRE.Actors().setRectangleActorWidth(this._id,a),this},b.prototype.mapAnimation=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this;if(param.required(a),param.required(c),e={},h=function(a){return a=0===a?".":a>=0?"+"+a:""+a},"width"===a[0]){for(c.startVal/=2,c.endVal/=2,d=JSON.stringify(c),AJS.info("Pre-calculating Bezier animation values for "+d),f=window.AdefyRE.Animations().preCalculateBez(d),f=JSON.parse(f),g=0,c.deltas=[],c.delays=[],c.udata=[],i=Number(f.values[0]),o=f.values,k=0,m=o.length;m>k;k++)j=o[k],j=Number(j),j-=i,i+=j,g+=Number(f.stepTime),0!==j&&(c.deltas.push([h(-j),".",h(-j),".",h(j),".",h(j),".",h(-j),"."]),c.udata.push(2*j),c.delays.push(g));c.cbStep=function(a){return q._width+=2*a},e.property=["vertices"],e.options=c}else{if("height"!==a[0])return b.__super__.mapAnimation.call(this,a,c);for(c.startVal/=2,c.endVal/=2,d=JSON.stringify(c),AJS.info("Pre-calculating Bezier animation values for "+d),f=window.AdefyRE.Animations().preCalculateBez(d),f=JSON.parse(f),g=0,c.deltas=[],c.delays=[],c.udata=[],i=Number(f.values[0]),p=f.values,l=0,n=p.length;n>l;l++)j=p[l],j=Number(j),j-=i,i+=j,g+=Number(f.stepTime),0!==j&&(c.deltas.push([".",h(-j),".",h(j),".",h(j),".",h(-j),".",h(-j)]),c.udata.push(j),c.delays.push(g));c.cbStep=function(a){return q._height+=2*a},e.property=["vertices"],e.options=c}return e},b.prototype.canMapAnimation=function(a){return"height"===a[0]||"width"===a[0]?!0:!1},b.prototype.absoluteMapping=function(){return!1},b.prototype.resize=function(a,b,c,d,e,f,g){var h,i;return a=param.optional(a,null),b=param.optional(b,null),void 0===e?(null!==a&&this.setWidth(a),null!==b&&this.setHeight(b),this):(void 0===f&&(f=0),void 0===g&&(g=[]),i=[],h=[],null!==a&&(param.required(c),i.push(["width"]),h.push({endVal:a,startVal:c,controlPoints:g,duration:e,start:f,property:"width"})),null!==b&&(param.required(d),i.push(["height"]),h.push({endVal:b,startVal:d,controlPoints:g,duration:e,start:f,property:"height"})),i.length>0&&AJS.animate(this,i,h),this)},b}(AJSBaseActor),AJSTriangle=function(a){function b(a){var c;if(a=param.required(a),this._base=param.required(a.base),this._height=param.required(a.height),this._base<=0)throw"Base must be wider than 0";if(this._height<=0)throw"Height must be greater than 0";c=AJS.getAutoScale(),this._base*=c.x,this._height*=c.y,this._rebuildVerts(),b.__super__.constructor.call(this,this._verts,a.mass,a.friction,a.elasticity),a.color instanceof AJSColor3?this.setColor(a.color):void 0!==a.color&&void 0!==a.color.r&&this.setColor(new AJSColor3(a.color.r,a.color.g,a.color.b)),a.position instanceof AJSVector2?this.setPosition(a.position):void 0!==a.position&&void 0!==a.position.x&&this.setPosition(new AJSVector2(a.position.x,a.position.y)),"number"==typeof a.rotation&&this.setRotation(a.rotation),a.psyx&&this.enablePsyx()}return __extends(b,a),b.prototype.interfaceActorCreate=function(){return AJS.info("Creating triangle actor..."),window.AdefyRE.Actors().createRawActor(JSON.stringify(this._verts))},b.prototype.getBase=function(){return this._fetchVertices(),this._base=2*this._verts[4]},b.prototype.getHeight=function(){return this._fetchVertices(),this._height=2*this._verts[3]},b.prototype._rebuildVerts=function(){var a,b;return a=this._base/2,b=this._height/2,this._verts=[8],this._verts[0]=-a,this._verts[1]=-b,this._verts[2]=0,this._verts[3]=b,this._verts[4]=a,this._verts[5]=-b,this._verts[6]=-a,this._verts[7]=-b},b.prototype.setHeight=function(a){if(param.required(a),0>=a)throw new Error("New height must be >0 !");return a*=AJS.getAutoScale().y,this._height=a,this._rebuildVerts(),this._updateVertices(),this},b.prototype.setBase=function(a){if(param.required(a),0>=a)throw new Error("New base must be >0 !");return a*=AJS.getAutoScale().x,this._base=a,this._rebuildVerts(),this._updateVertices(),this},b.prototype.mapAnimation=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this;if(param.required(a),param.required(c),i=AJS.getAutoScale(),e={},h=function(a){return a=0===a?".":a>=0?"+"+a:""+a},"height"===a[0]){for(c.startVal/=2,c.endVal/=2,c.startVal*=i.y,c.endVal*=i.y,d=JSON.stringify(c),AJS.info("Pre-calculating Bezier animation values for "+d),f=window.AdefyRE.Animations().preCalculateBez(d),f=JSON.parse(f),g=0,c.deltas=[],c.delays=[],c.udata=[],j=Number(f.values[0]),p=f.values,l=0,n=p.length;n>l;l++)k=p[l],k=Number(k),k-=j,j+=k,g+=Number(f.stepTime),0!==k&&(c.deltas.push([".",h(-k),".",h(k),".",h(-k),".",h(-k)]),c.udata.push(k),c.delays.push(g));c.cbStep=function(a){return r._height+=2*a},e.property=["vertices"],e.options=c}else{if("base"!==a[0])return b.__super__.mapAnimation.call(this,a,c);for(c.startVal/=2,c.endVal/=2,c.startVal*=i.x,c.endVal*=i.x,d=JSON.stringify(c),AJS.info("Pre-calculating Bezier animation values for "+d),f=window.AdefyRE.Animations().preCalculateBez(d),f=JSON.parse(f),g=0,c.deltas=[],c.delays=[],c.udata=[],j=Number(f.values[0]),q=f.values,m=0,o=q.length;o>m;m++)k=q[m],k=Number(k),k-=j,j+=k,g+=Number(f.stepTime),0!==k&&(c.deltas.push([h(-k),".",".",".",h(k),".",h(-k),"."]),c.udata.push(k),c.delays.push(g));c.cbStep=function(a){return r._base+=2*a},e.property=["vertices"],e.options=c}return e},b.prototype.canMapAnimation=function(a){return"base"===a[0]||"height"===a[0]?!0:!1},b.prototype.absoluteMapping=function(){return!1},b.prototype.resize=function(a,b,c,d,e,f,g){var h,i,j;return a=param.optional(a,null),b=param.optional(b,null),void 0===e?(null!==a&&this.setBase(a),null!==b&&this.setHeight(b),this):(void 0===f&&(f=0),void 0===g&&(g=[]),j=AJS.getAutoScale(),a*=j.x,b*=j.y,c*=j.x,d*=j.y,i=[],h=[],null!==a&&(param.required(c),i.push(["base"]),h.push({endVal:a,startVal:c,controlPoints:g,duration:e,start:f,property:"base"})),null!==b&&(param.required(d),i.push(["height"]),h.push({endVal:b,startVal:d,controlPoints:g,duration:e,start:f,property:"height"})),i.length>0&&AJS.animate(this,i,h),this)},b}(AJSBaseActor),AJSPolygon=function(a){function b(a){var c;if(param.required(a),this._radius=param.required(a.radius),this._segments=param.required(a.segments),a.psyx=param.optional(a.psyx,!1),this._radius<=0)throw"Radius must be larger than 0";if(this._segments<3)throw"Shape must consist of at least 3 segments";c=AJS.getAutoScale(),this.radius*=Math.min(c.x,c.y),this._rebuildVerts(!0),b.__super__.constructor.call(this,this._verts,a.mass,a.friction,a.elasticity),a.color instanceof AJSColor3?this.setColor(a.color):void 0!==a.color&&void 0!==a.color.r&&this.setColor(new AJSColor3(a.color.r,a.color.g,a.color.b)),a.position instanceof AJSVector2?this.setPosition(a.position):void 0!==a.position&&void 0!==a.position.x&&this.setPosition(new AJSVector2(a.position.x,a.position.y)),"number"==typeof a.rotation&&this.setRotation(a.rotation),a.psyx&&this.enablePsyx(),this._setPhysicsVertices(this._verts.slice(0,this._verts.length-2)),this._setRenderMode(1)}return __extends(b,a),b.prototype.interfaceActorCreate=function(){return AJS.info("Creating polygon actor ("+this._verts.length+" verts)"),window.AdefyRE.Actors().createPolygonActor(JSON.stringify(this._verts))},b.prototype._rebuildVerts=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(a=param.optional(a,!1),b=param.optional(b,!1),c=param.optional(c,this._segments),d=param.optional(d,this._radius),m=d,n=0,i=6.2831852/c,h=Math.tan(i),g=Math.cos(i),l=[],e=o=0;c>=0?c>o:o>c;e=c>=0?++o:--o)f=2*e,l[f]=m,l[f+1]=n,j=-n,k=m,m+=j*h,n+=k*h,m*=g,n*=g;for(l.push(l[0]),l.push(l[1]),r=[],e=p=0,q=l.length;q>p;e=p+=2)s=l[l.length-2-e],t=l[l.length-1-e],r.push(b?"`"+s:s),r.push(b?"`"+t:t);return l=r,a||b||this._setPhysicsVertices(l),l.push(b?"`0":0),l.push(b?"`0":0),b?l:this._verts=l},b.prototype.setRadius=function(a){if(param.required(a),0>=a)throw new Error("New radius must be >0 !");return this._radius=a,this._rebuildVerts(),this._updateVertices(),this},b.prototype.setSegments=function(a){if(param.required(a),3>a)throw new Error("New segment count must be >=3 !");return this._segments=a,this._rebuildVerts(),this._updateVertices(),this},b.prototype.getRadius=function(){return this._radius},b.prototype.getSegments=function(){return this._segments},b.prototype.mapAnimation=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=this;if(param.required(a),param.required(c),e={},this._fetchVertices(),h=function(a){return a=0===a?".":a>=0?"+"+a:""+a},d=JSON.stringify(c),"radius"===a[0]){for(AJS.info("Pre-calculating Bezier animation values for "+d),f=window.AdefyRE.Animations().preCalculateBez(d),f=JSON.parse(f),g=0,c.deltas=[],c.delays=[],c.udata=[],n=f.values,j=0,l=n.length;l>j;j++)i=n[j],i=Number(i),g+=Number(f.stepTime),0!==i&&(c.udata.push(i),c.deltas.push(this._rebuildVerts(!0,!0,this._segments,i)),c.delays.push(g));c.cbStep=function(a){return p._radius=a},e.property=["vertices"],e.options=c}else{if("sides"!==a[0])return b.__super__.mapAnimation.call(this,a,c);for(AJS.info("Pre-calculating Bezier animation values for "+d),f=window.AdefyRE.Animations().preCalculateBez(d),f=JSON.parse(f),g=0,c.deltas=[],c.delays=[],c.udata=[],o=f.values,k=0,m=o.length;m>k;k++)i=o[k],i=Number(i),g+=Number(f.stepTime),0!==i&&(c.udata.push(i),c.deltas.push(this._rebuildVerts(!0,!0,i,this._radius)),c.delays.push(g));c.cbStep=function(a){return p._segments=a},e.property=["vertices"],e.options=c}return e},b.prototype.canMapAnimation=function(a){return"sides"===a[0]||"radius"===a[0]?!0:!1},b.prototype.absoluteMapping=function(){return!0},b}(AJSBaseActor),AJSCircle=function(a){function b(a){var c;if(a=param.required(a),this._radius=param.required(a.radius),this._radius<=0)throw new Error("Radius must be greater than 0");c=AJS.getAutoScale(),this._radius*=(c.x+c.y)/2,this._rebuildVerts(),b.__super__.constructor.call(this,this._verts,a.mass,a.friction,a.elasticity),a.color instanceof AJSColor3?this.setColor(a.color):void 0!==a.color&&void 0!==a.color.r&&this.setColor(new AJSColor3(a.color.r,a.color.g,a.color.b)),a.position instanceof AJSVector2?this.setPosition(a.position):void 0!==a.position&&void 0!==a.position.x&&this.setPosition(new AJSVector2(a.position.x,a.position.y)),"number"==typeof a.rotation&&this.setRotation(a.rotation),a.psyx&&this.enablePsyx(),this._setRenderMode(1)}return __extends(b,a),b.prototype.interfaceActorCreate=function(){return AJS.info("Creating circle actor ["+this._radius+"]"),window.AdefyRE.Actors().createCircleActor(this._radius,JSON.stringify(this._verts))},b.prototype._rebuildVerts=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(d=param.optional(d,!1),a=param.optional(a,!1),b=param.optional(b,this._radius),g=32,m=b,n=0,i=6.2831852/g,h=Math.tan(i),f=Math.cos(i),l=[],c=o=0;g>=0?g>o:o>g;c=g>=0?++o:--o)e=2*c,l[e]=m,l[e+1]=n,j=-n,k=m,m+=j*h,n+=k*h,m*=f,n*=f;for(l.push(l[0]),l.push(l[1]),r=[],c=p=0,q=l.length;q>p;c=p+=2)s=l[l.length-2-c],t=l[l.length-1-c],r.push(a?"`"+s:s),r.push(a?"`"+t:t);return l=r,l.push(a?"`0":0),l.push(a?"`0":0),a?l:this._verts=l},b.prototype.getRadius=function(){return AJS.info("Fetching actor ("+this._id+") radius..."),this._radius=window.AdefyRE.Actors().getCircleActorRadius(this._id)},b.prototype.setRadius=function(a){if(param.required(a),0>=a)throw new Error("New radius must be >0 !");return AJS.info("Setting actor ("+this._id+") radius ["+a+"]..."),this._radius=a,this._rebuildVerts(),this._updateVertices(),window.AdefyRE.Actors().setCircleActorRadius(this._id,a),this},b.prototype.mapAnimation=function(a,c){var d,e,f,g,h,i,j,k,l=this;if(param.required(a),param.required(c),d={},g=function(a){return a=0===a?".":a>=0?"+"+a:""+a},"radius"!==a[0])return b.__super__.mapAnimation.call(this,a,c);for(AJS.info("Pre-calculating Bezier animation values for "+JSONopts),e=window.AdefyRE.Animations().preCalculateBez(JSONopts),e=JSON.parse(e),f=0,c.deltas=[],c.delays=[],c.udata=[],k=e.values,i=0,j=k.length;j>i;i++)h=k[i],h=Number(h),f+=Number(e.stepTime),0!==h&&(c.udata.push(h),c.deltas.push(this._rebuildVerts(!0,h)),c.delays.push(f));return c.cbStep=function(a){return l._radius=a},d.property=["vertices"],d.options=c,d},b.prototype.canMapAnimation=function(a){return"radius"===a[0]?!0:!1},b.prototype.absoluteMapping=function(){return!1},b}(AJSBaseActor),AJS=function(){function a(){throw new Error("AJS shouldn't be instantiated!")}return a.Version={MAJOR:1,MINOR:0,PATCH:10,BUILD:null,STRING:"1.0.10"},a._engine=null,a._initialized=!1,a._logLevel=2,a._scaleX=1,a._scaleY=1,a.setAutoScale=function(b,c){return a._scaleX=b,a._scaleY=c},a.getAutoScale=function(){return{x:a._scaleX,y:a._scaleY}},a.init=function(b,c,d,e){var f,g,h;if(param.required(b),param.required(c),param.required(d),a._initialized)return this.error("AJS can only be initialized once");for(a._initialized=!0,g=setTimeout(function(){},1),f=h=0;g>=0?g>h:h>g;f=g>=0?++h:--h)clearTimeout(f);return this._engine=window.AdefyRE.Engine(),void 0!==this._engine.setRendererMode&&(window.WebGLRenderingContext?(this._engine.setRendererMode(2),this.info("Proceeding with WebGL render mode")):(this._engine.setRendererMode(1),this.info("Dropping to canvas render mode"))),this._engine.initialize(c,d,function(a){return b(a)},2,e),this.info("Initialized AJS")},a.setLogLevel=function(a){return param.required(a,[0,1,2,3,4]),this.info("Setting log level to "+a),window.AdefyRE.Engine().setLogLevel(a),this._logLevel=a,this},a.log=function(a,b,c){return void 0===c&&(c=""),a>this._logLevel||0===a||0===this._logLevel?void 0:1===a&&void 0!==console.error?console.error?console.error(""+c+b):console.log(""+c+b):2===a&&void 0!==console.warn?console.warn?console.warn(""+c+b):console.log(""+c+b):3===a&&void 0!==console.debug?console.debug?console.debug(""+c+b):console.log(""+c+b):4===a&&void 0!==console.info?console.info?console.info(""+c+b):console.log(""+c+b):console.log(a>4&&void 0!==me.tags[a]?""+c+b:b)},a.warning=function(a){return this.log(2,a,"[WARNING] "),this},a.error=function(a){return this.log(1,a,"[ERROR] "),this},a.info=function(a){return this.log(4,a,"[INFO] "),this},a.debug=function(a){return this.log(3,a,"[DEBUG] "),this},a.setCameraPosition=function(b,c){return param.required(b),param.required(c),this.info("Setting camera position ("+b+", "+c+")"),b*=a._scaleX,c*=a._scaleY,window.AdefyRE.Engine().setCameraPosition(b,c),this},a.getCameraPosition=function(){var b;return this.info("Fetching camera position..."),b=JSON.parse(window.AdefyRE.Engine().getCameraPosition()),b.x/=a._scaleX,b.y/=a.scaleY,b},a.setClearColor=function(a,b,c){return param.required(a),param.required(b),param.required(c),this.info("Setting clear color to ("+a+", "+b+", "+c+")"),window.AdefyRE.Engine().setClearColor(a,b,c)},a.getClearColor=function(){var a;return this.info("Fetching clear color..."),a=JSON.parse(window.AdefyRE.Engine().getClearColor()),new AJSColor3(a.r,a.g,a.b)},a._syntheticMap={width:""},a.animate=function(b,c,d,e,f){var g,h,i,j,k,l,m,n;for(param.required(b),param.required(c),param.required(d),e=param.optional(e,0),f=param.optional(f,30),g=window.AdefyRE.Animations(),m=function(b,c,d,e){return setTimeout(function(){var e;return e=a.mapAnimation(b,c,d),c=JSON.stringify(e.property),d=JSON.stringify(e.options),g.animate(b.getId(),c,d)},e)},n=[],h=k=0,l=c.length;l>=0?l>k:k>l;h=l>=0?++k:--k)if(void 0===d[h].fps&&(d[h].fps=f),void 0===d[h].start&&(d[h].start=e),g.canAnimate(c[h][0]))d[h]=JSON.stringify(d[h]),c[h]=JSON.stringify(c[h]),n.push(g.animate(b.getId(),c[h],d[h]));else{if(!b.canMapAnimation(c[h]))throw new Error("Unrecognized property! "+c[h]);b.absoluteMapping(c[h])?(j=d[h].start,d[h].start=-1,n.push(m(b,c[h],d[h],j))):(i=a.mapAnimation(b,c[h],d[h]),c[h]=JSON.stringify(i.property),d[h]=JSON.stringify(i.options),n.push(g.animate(b.getId(),c[h],d[h])))}return n},a.mapAnimation=function(a,b,c){return param.required(a),param.required(b),param.required(c),a.mapAnimation(b,c)},a.loadManifest=function(a,b){return param.required(a),"string"!=typeof a&&(a=JSON.stringify(a)),b=param.optional(b,function(){}),this.info("Loading manifest "+JSON.stringify(a)),window.AdefyRE.Engine().loadManifest(a,b)},a.createRectangleActor=function(a,b,c,d,e,f,g,h){var i,j,k;param.required(a),param.required(b),param.required(c),param.required(d),j={position:{x:a,y:b},color:{r:e,g:f,b:g},w:c,h:d};for(i in h)k=h[i],j[i]=k;return new AJSRectangle(j)},a.createSquareActor=function(b,c,d,e,f,g){return param.required(b),param.required(c),param.required(d),a.createRectangleActor(b,c,d,d,e,f,g)},a.createCircleActor=function(a,b,c,d,e,f,g){var h,i,j;param.required(a),param.required(b),param.required(c),i={position:{x:a,y:b},color:{r:d,g:e,b:f},radius:c};for(h in g)j=g[h],i[h]=j;return new AJSCircle(i)},a.createPolygonActor=function(a,b,c,d,e,f,g,h){var i,j,k;param.required(a),param.required(b),param.required(c),param.required(d),j={position:{x:a,y:b},color:{r:e,g:f,b:g},radius:c,segments:d};for(i in h)k=h[i],j[i]=k;return new AJSPolygon(j)},a.createTriangleActor=function(a,b,c,d,e,f,g,h){var i,j,k;param.required(a),param.required(b),param.required(c),param.required(d),void 0===e&&(e=Math.floor(255*Math.random())),void 0===f&&(f=Math.floor(255*Math.random())),void 0===g&&(g=Math.floor(255*Math.random())),j={position:{x:a,y:b},color:{r:e,g:f,b:g},base:c,height:d};for(i in h)k=h[i],j[i]=k;return new AJSTriangle(j)},a.getTextureSize=function(a){return param.required(a),this.info("Fetching texture size by name ("+a+")"),window.AdefyRE.Engine().getTextureSize(a)},a.setRemindMeLaterButton=function(a,b,c,d){return window.AdefyRE.Engine().setRemindMeButton(a,b,c,d)},a}();